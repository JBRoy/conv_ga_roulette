Using device: cpu
Starting with 10 Population:
[Arch(conv=1, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=4, acc=0.0000), Arch(conv=1, acc=0.0000), Arch(conv=1, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=2, acc=0.0000)]


============================================================
Generation 1/5
============================================================
Evaluating architecture 1/10...     [Arch Details] Acc: 0.3000 | Conv Params: 1248 | FC Params: 1051402 | Penalty: 0.0053
Weighted Fitness: 0.2947, Accuracy: 0.3000
Evaluating architecture 2/10...     [Arch Details] Acc: 0.3000 | Conv Params: 813696 | FC Params: 2099978 | Penalty: 0.0268
Weighted Fitness: 0.2732, Accuracy: 0.3000
Evaluating architecture 3/10...     [Arch Details] Acc: 0.1000 | Conv Params: 565808 | FC Params: 525002 | Penalty: 0.0139
Weighted Fitness: 0.0861, Accuracy: 0.1000
Evaluating architecture 4/10...     [Arch Details] Acc: 0.4000 | Conv Params: 2496 | FC Params: 4199946 | Penalty: 0.0210
Weighted Fitness: 0.3790, Accuracy: 0.4000
Evaluating architecture 5/10...     [Arch Details] Acc: 0.2000 | Conv Params: 1920 | FC Params: 4197130 | Penalty: 0.0210
Weighted Fitness: 0.1790, Accuracy: 0.2000
Evaluating architecture 6/10...     [Arch Details] Acc: 0.1000 | Conv Params: 78976 | FC Params: 1051402 | Penalty: 0.0068
Weighted Fitness: 0.0932, Accuracy: 0.1000
Evaluating architecture 7/10...     [Arch Details] Acc: 0.4000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.3959, Accuracy: 0.4000
Evaluating architecture 8/10...     [Arch Details] Acc: 0.0000 | Conv Params: 51920 | FC Params: 66250 | Penalty: 0.0014
Weighted Fitness: -0.0014, Accuracy: 0.0000
Evaluating architecture 9/10...     [Arch Details] Acc: 0.3000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.2980, Accuracy: 0.3000
Evaluating architecture 10/10...     [Arch Details] Acc: 0.4000 | Conv Params: 202048 | FC Params: 4195722 | Penalty: 0.0250
Weighted Fitness: 0.3750, Accuracy: 0.4000

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=3, acc=0.4000)

Best overall: Arch(conv=3, acc=0.4000)

Performing Roulette Wheel selection of total population: 10 ...

    [Roulette Probabilities]
    Arch 0: Fitness=0.3959 -> Prob=0.1638
    Arch 1: Fitness=0.3790 -> Prob=0.1570
    Arch 2: Fitness=0.3750 -> Prob=0.1554
    Arch 3: Fitness=0.2980 -> Prob=0.1244
    Arch 4: Fitness=0.2947 -> Prob=0.1231
    Arch 5: Fitness=0.2732 -> Prob=0.1145
    Arch 6: Fitness=0.1790 -> Prob=0.0766
    Arch 7: Fitness=0.0932 -> Prob=0.0420
    Arch 8: Fitness=0.0861 -> Prob=0.0392
    Arch 9: Fitness=-0.0014 -> Prob=0.0040
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=3, acc=0.4000), Arch(conv=1, acc=0.4000), Arch(conv=3, acc=0.3000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.4000), Arch(conv=3, acc=0.3000), Arch(conv=3, acc=0.0000), Arch(conv=1, acc=0.0000), Arch(conv=3, acc=0.3000), Arch(conv=3, acc=0.3000)]

============================================================
Generation 2/5
============================================================
Evaluating architecture 1/10...     [Arch Details] Acc: 0.2000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.1959, Accuracy: 0.2000
Evaluating architecture 2/10...     [Arch Details] Acc: 0.3000 | Conv Params: 2496 | FC Params: 4199946 | Penalty: 0.0210
Weighted Fitness: 0.2790, Accuracy: 0.3000
Evaluating architecture 3/10...     [Arch Details] Acc: 0.3000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.2980, Accuracy: 0.3000
Evaluating architecture 4/10...     [Arch Details] Acc: 0.3000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.2980, Accuracy: 0.3000
Evaluating architecture 5/10...     [Arch Details] Acc: 0.2000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.1959, Accuracy: 0.2000
Evaluating architecture 6/10...     [Arch Details] Acc: 0.1000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.0980, Accuracy: 0.1000
Evaluating architecture 7/10...     [Arch Details] Acc: 0.0000 | Conv Params: 48240 | FC Params: 264970 | Penalty: 0.0023
Weighted Fitness: -0.0023, Accuracy: 0.0000
Evaluating architecture 8/10...     [Arch Details] Acc: 0.3000 | Conv Params: 19200 | FC Params: 2097866 | Penalty: 0.0109
Weighted Fitness: 0.2891, Accuracy: 0.3000
Evaluating architecture 9/10...     [Arch Details] Acc: 0.3000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.2980, Accuracy: 0.3000
Evaluating architecture 10/10...     [Arch Details] Acc: 0.0000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: -0.0020, Accuracy: 0.0000

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=3, acc=0.3000)

Best overall: Arch(conv=3, acc=0.4000)

Performing Roulette Wheel selection of total population: 10 ...

    [Roulette Probabilities]
    Arch 0: Fitness=0.2980 -> Prob=0.1499
    Arch 1: Fitness=0.2980 -> Prob=0.1499
    Arch 2: Fitness=0.2980 -> Prob=0.1499
    Arch 3: Fitness=0.2891 -> Prob=0.1456
    Arch 4: Fitness=0.2790 -> Prob=0.1406
    Arch 5: Fitness=0.1959 -> Prob=0.1005
    Arch 6: Fitness=0.1959 -> Prob=0.1005
    Arch 7: Fitness=0.0980 -> Prob=0.0533
    Arch 8: Fitness=-0.0020 -> Prob=0.0050
    Arch 9: Fitness=-0.0023 -> Prob=0.0048
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=3, acc=0.3000), Arch(conv=3, acc=0.3000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=1, acc=0.0000), Arch(conv=1, acc=0.0000), Arch(conv=1, acc=0.3000), Arch(conv=3, acc=0.0000), Arch(conv=1, acc=0.3000), Arch(conv=3, acc=0.3000)]

============================================================
Generation 3/5
============================================================
Evaluating architecture 1/10...     [Arch Details] Acc: 0.3000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.2980, Accuracy: 0.3000
Evaluating architecture 2/10...     [Arch Details] Acc: 0.3000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.2980, Accuracy: 0.3000
Evaluating architecture 3/10...     [Arch Details] Acc: 0.2000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.1959, Accuracy: 0.2000
Evaluating architecture 4/10...     [Arch Details] Acc: 0.4000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.3959, Accuracy: 0.4000
Evaluating architecture 5/10...     [Arch Details] Acc: 0.3000 | Conv Params: 19200 | FC Params: 2097866 | Penalty: 0.0109
Weighted Fitness: 0.2891, Accuracy: 0.3000
Evaluating architecture 6/10...     [Arch Details] Acc: 0.3000 | Conv Params: 19200 | FC Params: 2097866 | Penalty: 0.0109
Weighted Fitness: 0.2891, Accuracy: 0.3000
Evaluating architecture 7/10...     [Arch Details] Acc: 0.3000 | Conv Params: 19200 | FC Params: 2097866 | Penalty: 0.0109
Weighted Fitness: 0.2891, Accuracy: 0.3000
Evaluating architecture 8/10...     [Arch Details] Acc: 0.2000 | Conv Params: 155328 | FC Params: 263562 | Penalty: 0.0044
Weighted Fitness: 0.1956, Accuracy: 0.2000
Evaluating architecture 9/10...     [Arch Details] Acc: 0.2000 | Conv Params: 19200 | FC Params: 2097866 | Penalty: 0.0109
Weighted Fitness: 0.1891, Accuracy: 0.2000
Evaluating architecture 10/10...     [Arch Details] Acc: 0.2000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.1980, Accuracy: 0.2000

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=3, acc=0.4000)

Best overall: Arch(conv=3, acc=0.4000)

Performing Roulette Wheel selection of total population: 10 ...

    [Roulette Probabilities]
    Arch 0: Fitness=0.3959 -> Prob=0.1482
    Arch 1: Fitness=0.2980 -> Prob=0.1125
    Arch 2: Fitness=0.2980 -> Prob=0.1125
    Arch 3: Fitness=0.2891 -> Prob=0.1093
    Arch 4: Fitness=0.2891 -> Prob=0.1093
    Arch 5: Fitness=0.2891 -> Prob=0.1093
    Arch 6: Fitness=0.1980 -> Prob=0.0760
    Arch 7: Fitness=0.1959 -> Prob=0.0752
    Arch 8: Fitness=0.1956 -> Prob=0.0751
    Arch 9: Fitness=0.1891 -> Prob=0.0727
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=3, acc=0.4000), Arch(conv=3, acc=0.3000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=1, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000)]

============================================================
Generation 4/5
============================================================
Evaluating architecture 1/10...     [Arch Details] Acc: 0.3000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.2959, Accuracy: 0.3000
Evaluating architecture 2/10...     [Arch Details] Acc: 0.3000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.2980, Accuracy: 0.3000
Evaluating architecture 3/10...     [Arch Details] Acc: 0.1000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.0959, Accuracy: 0.1000
Evaluating architecture 4/10...     [Arch Details] Acc: 0.2000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.1980, Accuracy: 0.2000
Evaluating architecture 5/10...     [Arch Details] Acc: 0.1000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.0980, Accuracy: 0.1000
Evaluating architecture 6/10...     [Arch Details] Acc: 0.5000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.4980, Accuracy: 0.5000
Evaluating architecture 7/10...     [Arch Details] Acc: 0.2000 | Conv Params: 1248 | FC Params: 525706 | Penalty: 0.0027
Weighted Fitness: 0.1973, Accuracy: 0.2000
Evaluating architecture 8/10...     [Arch Details] Acc: 0.3000 | Conv Params: 466144 | FC Params: 131786 | Penalty: 0.0100
Weighted Fitness: 0.2900, Accuracy: 0.3000
Evaluating architecture 9/10...     [Arch Details] Acc: 0.4000 | Conv Params: 155328 | FC Params: 263562 | Penalty: 0.0044
Weighted Fitness: 0.3956, Accuracy: 0.4000
Evaluating architecture 10/10...     [Arch Details] Acc: 0.1000 | Conv Params: 31648 | FC Params: 1054218 | Penalty: 0.0059
Weighted Fitness: 0.0941, Accuracy: 0.1000

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=3, acc=0.5000)

Best overall: Arch(conv=3, acc=0.5000)

Performing Roulette Wheel selection of total population: 10 ...

    [Roulette Probabilities]
    Arch 0: Fitness=0.4980 -> Prob=0.1984
    Arch 1: Fitness=0.3956 -> Prob=0.1584
    Arch 2: Fitness=0.2980 -> Prob=0.1203
    Arch 3: Fitness=0.2959 -> Prob=0.1194
    Arch 4: Fitness=0.2900 -> Prob=0.1171
    Arch 5: Fitness=0.1980 -> Prob=0.0812
    Arch 6: Fitness=0.1973 -> Prob=0.0810
    Arch 7: Fitness=0.0980 -> Prob=0.0422
    Arch 8: Fitness=0.0959 -> Prob=0.0413
    Arch 9: Fitness=0.0941 -> Prob=0.0406
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=3, acc=0.5000), Arch(conv=3, acc=0.4000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=4, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000)]

============================================================
Generation 5/5
============================================================
Evaluating architecture 1/10...     [Arch Details] Acc: 0.2000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.1980, Accuracy: 0.2000
Evaluating architecture 2/10...     [Arch Details] Acc: 0.1000 | Conv Params: 155328 | FC Params: 263562 | Penalty: 0.0044
Weighted Fitness: 0.0956, Accuracy: 0.1000
Evaluating architecture 3/10...     [Arch Details] Acc: 0.3000 | Conv Params: 126752 | FC Params: 525706 | Penalty: 0.0052
Weighted Fitness: 0.2948, Accuracy: 0.3000
Evaluating architecture 4/10...     [Arch Details] Acc: 0.4000 | Conv Params: 155328 | FC Params: 263562 | Penalty: 0.0044
Weighted Fitness: 0.3956, Accuracy: 0.4000
Evaluating architecture 5/10...     [Arch Details] Acc: 0.2000 | Conv Params: 31648 | FC Params: 263562 | Penalty: 0.0020
Weighted Fitness: 0.1980, Accuracy: 0.2000
Evaluating architecture 6/10...     [Arch Details] Acc: 0.1000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.0959, Accuracy: 0.1000
Evaluating architecture 7/10...     [Arch Details] Acc: 0.3000 | Conv Params: 155328 | FC Params: 263562 | Penalty: 0.0044
Weighted Fitness: 0.2956, Accuracy: 0.3000
Evaluating architecture 8/10...     [Arch Details] Acc: 0.2000 | Conv Params: 214432 | FC Params: 525002 | Penalty: 0.0069
Weighted Fitness: 0.1931, Accuracy: 0.2000
Evaluating architecture 9/10...     [Arch Details] Acc: 0.4000 | Conv Params: 155328 | FC Params: 263562 | Penalty: 0.0044
Weighted Fitness: 0.3956, Accuracy: 0.4000
Evaluating architecture 10/10...     [Arch Details] Acc: 0.3000 | Conv Params: 140320 | FC Params: 262858 | Penalty: 0.0041
Weighted Fitness: 0.2959, Accuracy: 0.3000

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=3, acc=0.4000)

Best overall: Arch(conv=3, acc=0.5000)

Performing Roulette Wheel selection of total population: 10 ...

    [Roulette Probabilities]
    Arch 0: Fitness=0.3956 -> Prob=0.1585
    Arch 1: Fitness=0.3956 -> Prob=0.1585
    Arch 2: Fitness=0.2959 -> Prob=0.1196
    Arch 3: Fitness=0.2956 -> Prob=0.1195
    Arch 4: Fitness=0.2948 -> Prob=0.1192
    Arch 5: Fitness=0.1980 -> Prob=0.0813
    Arch 6: Fitness=0.1980 -> Prob=0.0813
    Arch 7: Fitness=0.1931 -> Prob=0.0794
    Arch 8: Fitness=0.0959 -> Prob=0.0414
    Arch 9: Fitness=0.0956 -> Prob=0.0413
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=3, acc=0.4000), Arch(conv=3, acc=0.4000), Arch(conv=3, acc=0.3000), Arch(conv=3, acc=0.3000), Arch(conv=2, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=4, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=3, acc=0.0000)]

============================================================
FINAL BEST ARCHITECTURE
============================================================
Genes: {'num_conv': 3, 'conv_configs': [{'filters': 16, 'kernel_size': 5}, {'filters': 32, 'kernel_size': 3}, {'filters': 32, 'kernel_size': 5}], 'pool_type': 'max', 'activation': 'leaky_relu', 'fc_units': 128}
Accuracy: 0.5000
Fitness: 0.4980

Total parameters: 295,210

Model architecture:
CNN(
  (features): Sequential(
    (0): Conv2d(3, 16, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): LeakyReLU(negative_slope=0.1, inplace=True)
    (3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): LeakyReLU(negative_slope=0.1, inplace=True)
    (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (7): Conv2d(32, 32, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): LeakyReLU(negative_slope=0.1, inplace=True)
    (10): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (classifier): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=2048, out_features=128, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.5, inplace=False)
    (4): Linear(in_features=128, out_features=10, bias=True)
  )
)
